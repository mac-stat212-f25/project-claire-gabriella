---
title: "msg"
format: html
---

High scores are given to words that are frequent in a single document (high TF) but rare in the overall corpus (high IDF). These words are often considered the most important or "telling" words for that document. 
Low TF-IDF scores are given to words that are either not very frequent in the document or are very common across all documents. 


```{r eval=FALSE}
# Code to clean and convert into matrix
library(readr)
library(stringr)
library(dplyr)
library(lubridate)
library(tidytext)
library(ggplot2)

df <- readRDS("../data/processed/jade.rds")

df <- df %>%
  mutate(
    date = ymd_hms(date),
    year  = year(date),
    month = month(date),
    day   = day(date),
    time  = format(date, "%H:%M:%S")
  )

df$id <- 1:nrow(df)

word_counts <- df %>%
  unnest_tokens(word, text) %>% 
  count(id, word, sort = TRUE)

word_counts <- word_counts %>%
  bind_tf_idf(term = word, document = id, n)

word_counts <- word_counts |> 
  filter(str_length(word) > 5)

word_counts %>% 
  slice_max(tf_idf, n = 15) %>% 
  mutate(word = reorder(word, tf_idf)) %>%
  ggplot(aes(tf_idf, word)) +
  geom_col(show.legend = FALSE) +
  labs(x = "tf-idf", y = NULL) 
```

```{r eval=FALSE}
df$id <- seq_len(nrow(df))   
tfidf <- df %>%
  unnest_tokens(word, text) %>%
  count(id, word) %>%
  bind_tf_idf(word, id, n)
df_joined <- df %>%
  left_join(tfidf %>% group_by(id) %>% summarise(tfidf = list(cur_data_all())),
            by = "id")
df_tidy <- df %>% left_join(tfidf, by = "id")
```

```{r eval=FALSE}
library(Matrix)

tfidf_matrix <- tfidf %>%
  cast_sparse(id, word, tf_idf)
```

